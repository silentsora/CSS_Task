<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS-task4-2</title>
    <link href="task2.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="header">
    <span>法官日记</span>
    <a href="task4-1.html"><img class="icon1" src="img-js-task2/back.png"></a>
    <a href="task2-1.html"><img class="icon2" src="img-js-task2/close.png"></a>
</div>
<div class="content">
    <div class="first-day">
        <span id="day">第 1 天</span>
    </div>
    <div class="process">
        <div class="step" onclick="kill('killer')">杀手杀人</div>
        <div class="step" onclick="kill('police')">警察验人</div>
        <div class="step" onclick="kill('sniper')">狙击狙人</div>
        <div class="step" onclick="kill('doctor')">医生救人</div>
        <div class="blank"></div>
        <div class="step">亡灵发表遗言</div>
        <div class="step">玩家依次发言</div>
        <div class="step">投票</div>
        <img class="night" src="img-js-task2/night.png">
        <img class="day" src="img-js-task2/day.png">
        <div class="line"></div>
    </div>
</div>
<script>
    var temp=localStorage;
    var action=new Array;       //action为行动阶段参数
    if(temp.getItem("action")) {
        action = JSON.parse(temp.getItem("action"));
        console.log(action);
        var day = 1;
        for (var i = 0; i < action.length; i++) {
            if (action[i] == "nextDay") {      //计算目前是第几天
                day++;
            }
        }
        document.getElementById("day").innerHTML = "第 " + day + " 天";
    }
    function kill(job){
        if(job=='killer'){      //进入杀手杀人阶段
            if(temp.getItem("action")){
                action.push(job);
            }
            else{
                action[0]=job;  //首次进入杀人阶段
            }
            temp.setItem("action",JSON.stringify(action));
            location.href="task4-1.html";
        }
        else{
            alert('功能尚未开放');
        }
    }
</script>
</body>
</html>